<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Libros Jur√≠dicos Maestros</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
:root {
  --bg:#ffffff; /* fondo blanco */
  --card:#111833; /* azul marino para las tarjetas y tabla */
  --muted:#555555; /* texto secundario gris */
  --text:#222222; /* texto principal oscuro */
  --accent:#1e40af; /* azul fuerte para botones */
  --accent-2:#3b82f6; /* azul m√°s claro para detalles */
  --radius:16px;
  --shadow:0 4px 12px rgba(0,0,0,.15);
  --ring: rgba(30,64,175,.25);
}
*{box-sizing:border-box;}
body{margin:0;font-family:Inter,Arial,sans-serif;background:var(--bg);color:var(--text);}
.container{max-width:1100px;margin:0 auto;padding:28px 16px 60px;}
h1{text-align:center;margin-bottom:4px;}
.subtitle{text-align:center;color:var(--muted);margin-bottom:20px;}
.search-box{display:flex;justify-content:center;margin-bottom:20px;}
.search-box input{
  padding:12px 20px;
  border-radius:999px;
  border:1px solid #ccc;
  background:#fff;
  color:var(--text);
  font-size:16px;
  outline:none;
  width:300px;
  max-width:90%;
  transition: all .2s;
}
.search-box input:focus{
  border-color:var(--accent);
  box-shadow:0 0 0 4px var(--ring);
}
table {
  width:100%;
  border-collapse:collapse;
  background:var(--card); /* azul marino */
  border-radius:var(--radius);
  box-shadow:var(--shadow);
  overflow:hidden;
  color:#e9ecf5; /* texto claro dentro de la tabla */
}
th,td{padding:14px 16px; text-align:left;}
th{
  font-size:12px;
  text-transform:uppercase;
  color:var(--accent-2);
  border-bottom:1px solid rgba(255,255,255,.1);
}
tr:hover{background:rgba(59,130,246,.1);}
a.button{
  display:inline-block;
  padding:6px 12px;
  background:var(--accent);
  color:#fff;
  border-radius:10px;
  text-decoration:none;
  font-weight:600;
}
a.button:hover{filter:brightness(1.05);}
mark{
  background:rgba(255,238,0,.6);
  padding:0 2px;
  border-radius:4px;
}
@media(max-width:600px){
  .search-box{flex-direction:column;align-items:center;}
  th,td{font-size:14px;}
}
</style>
</head>
<body>
<div class="container">
<h1>üìö Libros Jur√≠dicos Maestros</h1>
<div class="subtitle">Buscador conectado a Google Sheets by Jerrys</div>
<div class="search-box">
<input type="text" id="search" placeholder="Buscar por libro o autor..."/>
</div>
<table id="results">
<thead><tr><th>Libro</th><th>Autor</th><th>Acci√≥n</th></tr></thead>
<tbody></tbody>
</table>
</div>

<script>
const SHEET_JSON_URL = "https://script.google.com/macros/s/AKfycbzTWDDTlU6vEdDWGl-8REGSG-42kbUtx3P4SMOeBLfakbtcbDINWUq7laFAFsWaomr1Dw/exec";
let allData = [];

async function fetchSheet(){
  const res = await fetch(SHEET_JSON_URL);
  if(!res.ok) throw new Error("No se pudo obtener datos del Apps Script");
  const data = await res.json();
  if(data.error) throw new Error(data.error);
  return data;
}

function highlight(text, query){
  if(!query) return text;
  const regex = new RegExp(`(${query})`, "gi");
  return text.replace(regex, "<mark>$1</mark>");
}

function renderTable(data, query=""){
  const tbody = document.querySelector("#results tbody");
  tbody.innerHTML = "";
  data.forEach(row=>{
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td>${highlight(row.libro, query)}</td>
      <td>${highlight(row.autor, query)}</td>
      <td><a class="button" href="${row.link}" target="_blank">Abrir</a></td>
    `;
    tbody.appendChild(tr);
  });
}

document.getElementById("search").addEventListener("input", e=>{
  const q = e.target.value.trim().toLowerCase();
  const filtered = allData.filter(r=> r.libro.toLowerCase().includes(q) || r.autor.toLowerCase().includes(q));
  renderTable(filtered, q);
});

(async ()=>{
  try{
    allData = await fetchSheet();
    renderTable(allData);
  }catch(err){
    console.error(err);
    alert("No se pudieron cargar los libros: " + err.message);
  }
})();
</script>
</body>
</html>
